<!-- Les librairies en adaptation de maillage s'appuient sur deux types de structure de données: le patch-based ou le cell-based. Chacune de ces structures a ses propres avantages et inconvénients. Le patch-based permet d'avoir une bonne localité mémoire mais demande plus de cellules que nécessaire dans les zones à raffiner. Le cell-based, quant à lui, est plus efficace en termes de mémoire puisqu'il adapte uniquement les cellules nécessaires, mais la structure intrinsèque du maillage s'apparentant à un arbre demande d'utiliser des techniques comme les courbes de remplissage de l'espace pour s'assurer que les voisins ne sont pas très loin.
Nous proposons ici une nouvelle structure de données qui combine les avantages des deux structures existantes. Elle s'appuie sur une représentation récursive du maillage par intervalles dans chacune des directions et d'une algèbre d'ensemble permettant de retrouver efficacement des cellules intervenant à différentes étapes du calcul (les ghosts, les parents, ...). Cette représentation offre une vision très compressée du maillage et assure une contiguité mémoire selon un axe.
Pendant cette présentation, nous introduirons cette nouvelle structure de données et son implémentation dans le logiciel open-source samurai. Nous démontrerons sa grande flexibilité pour écrire des opérations complexes entre grilles grâce à l'algèbre d'ensemble. Son utilisation est généraliste et permet d'aborder les différentes méthodes d'adaptation de maillage sur grilles cartésiennes par cellules ou par points que ce soit avec des estimateurs heuristiques ou l'utilisation de la multirésolution s'appuyant sur une décomposition en base d'ondelettes assurant un contrôle de l'erreur entre la solution fine et la solution adaptée. Cette structure récursive permet également d'aborder des problèmes Nd où n>3.
Le logiciel samurai offre également un ensemble de schémas en espace (volumes finis, schémas lattice boltzmann, ...) permettant d'implémenter rapidement et efficacement des solveurs sur maillages adaptatifs. Différents schémas temporels peuvent être utilisés et s'appuient sur la librairie PETSc pour la résolution des systèmes linéaires et non-linéaires. Nous conclurons cette présentation par des exemples d'applications illustrant la flexibilité et la puissance de notre structure de données pour traiter des problèmes complexes en utilisant des maillages adaptatifs. -->

Adaptive mesh refinement software is based on two types of data structures: patch-based or cell-based. Each of these structures possesses its own advantages and disadvantages. The patch-based approach offers the benefit of good memory locality; however, it necessitates a greater number of cells than is necessary in areas intended for refinement. Conversely, cell-based methods exhibit superior memory efficiency by adapting only the necessary cells. However, the inherent tree-like structure of the mesh necessitates the utilization of techniques such as space-filling curves to ensure that neighbors are proximate.

In this talk, we propose a new data structure that integrates the strengths of both existing data structures. This novel approach is based on a recursive representation of the mesh by intervals in each direction, as well as a set algebra that facilitates the efficient retrieval of cells involved in different computation steps (ghosts, parents, etc.). This representation offers a highly compressed view of the mesh and ensures memory contiguity along one axis.

The subsequent presentation will introduce this novel data structure and its implementation in the open-source software samurai. We will demonstrate its remarkable flexibility for writing complex operations between grids thanks to set algebra. The software's versatility extends to its capacity to address diverse mesh adaptation methods on Cartesian grids, whether by cells or points, employing heuristic estimators or multiresolution based on wavelet decomposition. The latter ensures control of the error between the fine solution and the adapted solution and is independent of the problem solved. The recursive nature of the samurai software enables the resolution of problems with a dimension greater than 3. Additionally, samurai offers a suite of spatial schemes, including finite volumes and lattice boltzmann schemes, facilitating the expeditious and efficient implementation of solvers on adaptive meshes. The implementation of different time schemes is enabled, with reliance on the PETSc library for the solution of linear and non-linear systems. MPI is employed for the purpose of parallelization, while Kokkos experiments are conducted for the purpose of GPU support. This presentation will conclude with application examples illustrating the flexibility and power of our data structure for handling complex problems using adaptive meshes.